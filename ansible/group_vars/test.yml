---
# ========================================
# Variables environnement TEST (Multipass)
# ========================================

deploy_environment: test

# Features conditionnelles
enable_gpu: false
enable_letsencrypt: false
enable_zfs_snapshots: false

# Domaine de base
base_domain: "epicea-test.local"

# Domaines des services
service_domains:
  traefik: "traefik.{{ base_domain }}"
  immich: "photos.{{ base_domain }}"
  jellyfin: "jellyfin.{{ base_domain }}"
  nextcloud: "cloud.{{ base_domain }}"
  grafana: "monitoring.{{ base_domain }}"
  dozzle: "logs.{{ base_domain }}"
  pgadmin: "db.{{ base_domain }}"

# Configuration NFS (Storage VM)
nfs_server: "172.17.40.32" # IP_STORAGE_TEST
nfs_mounts:
  - src: "{{ nfs_server }}:/exports/media"
    path: "/mnt/media"
    opts: "rw,hard,intr,nfsvers=4"
  - src: "{{ nfs_server }}:/exports/photos"
    path: "/mnt/photos"
    opts: "rw,hard,intr,nfsvers=4"
  - src: "{{ nfs_server }}:/exports/cloud"
    path: "/mnt/cloud"
    opts: "rw,hard,intr,nfsvers=4"
    owner: "33" # www-data
    group: "33"
  - src: "{{ nfs_server }}:/exports/backups"
    path: "/mnt/backups"
    opts: "rw,hard,intr,nfsvers=4"

# Services activés
enabled_services:
  - shared-services  # Postgres + Redis mutualisés
  - traefik
  - immich
  - jellyfin
  - nextcloud
  - monitoring

# Chemins de base
base_path: "/opt/epicea"
docker_compose_path: "{{ base_path }}/docker"
config_path: "{{ base_path }}/config"
data_path: "{{ base_path }}/data"

# Configuration Traefik (test)
traefik_acme_enabled: false  # Pas de Let's Encrypt en test
traefik_dashboard_enabled: true
traefik_log_level: "DEBUG"
traefik_auth: "admin:$apr1$1aZVZLrd$t8WqKSkO2NX/JYudCgp06."  # admin/admin en test (htpasswd)

# Configuration Docker
docker_log_max_size: "10m"
docker_log_max_file: "3"

# Monitoring
prometheus_retention: "15d"  # Moins long en test
prometheus_scrape_interval: "15s"
prometheus_evaluation_interval: "15s"
prometheus_cadvisor_enabled: true  # Monitoring Docker
grafana_admin_user: "admin"
grafana_admin_password: "admin"  # À changer en production !
grafana_root_url: "https://monitoring.epicea-test.local"
grafana_plugins: ""  # Plugins Grafana à installer (séparés par ,)
grafana_middlewares: ""  # Middlewares Traefik optionnels

# Backup
backup_enabled: false  # Pas de backups automatiques en test
backup_retention_days: 7

# Notifications
# Pas de notifications Discord/Telegram par défaut si discord_webhook_url n'est pas défini dans le vault
